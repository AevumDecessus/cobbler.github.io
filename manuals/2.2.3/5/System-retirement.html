<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Cobbler Manual</title>
   <meta name="author" content="Cobbler development team" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/style.css" type="text/css" />

   <!-- Fonts -->
   <link href='http://fonts.googleapis.com/css?family=Signika|Ovo' rel='stylesheet' type='text/css'>

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

   <!-- Icon -->
   <link rel="icon" type="image/png" href="/images/favicon.png" />
</head>
<body>

<!-- ClickTale Top part -->
<script type="text/javascript">
var WRInitTime=(new Date()).getTime();
</script>
<!-- ClickTale end of Top part -->


<div id="wrapper">
  <div id="header"><img id="logo" src="/images/logo-cobbler.png" alt="logo" /></div> <!-- header -->
  <div id="container">
    <div id="leftcol">
<div id="mainmenu" class="menu">
  <div class="heading">Main Menu</div>
  <ul>
    <li><a href="/" title="Index">Home</a></li>
    <li class="last"><a href="/about.html" title="About Cobbler">About Cobbler</a></li>
  </ul>
  <div class="heading">Manuals</div>
  <ul>
    <li class="last"><a href="/manuals/2.2.3/" title="Version 2.2.3">Version 2.2.3</a></li>
  </ul>
  <div class="heading">Github</div>
  <ul>
    <li><a href="https://github.com/cobbler/cobbler" title="Main Repo" target="_blank">Main Repo</a></li>
    <li><a href="https://github.com/cobbler/cobbler/issues" title="Issues" target="_blank">Issue Tracker</a></li>
    <li class="last"><a href="https://github.com/cobbler/cobbler/wiki" title="Github Wiki" target="_blank">Wiki</a></li>
  </ul>
</div>

    </div> <!-- leftcol -->
    <div id="rightcol">
<div class="toc"><ul class="dirtree"><li><a href="/manuals/2.2.3/5/Advanced-networking.html">Advanced-networking</a></li><li><a href="/manuals/2.2.3/5/Alternative_Template_Formats.html">Alternative Template Formats</a></li><li><a href="/manuals/2.2.3/5/Anaconda-monitoring.html">Anaconda-monitoring</a></li><li><a href="/manuals/2.2.3/5/Auto-registration.html">Auto-registration</a></li><li><a href="/manuals/2.2.3/5/Batch-editing.html">Batch-editing</a></li><li><a href="/manuals/2.2.3/5/Built-in-configuration-management.html">Built-in-configuration-management</a></li><li><a href="/manuals/2.2.3/5/Clonezilla-integration.html">Clonezilla-integration</a></li><li><a href="/manuals/2.2.3/5/Filesystem-acls.html">Filesystem-acls</a></li><li><a href="/manuals/2.2.3/5/Func-integration.html">Func-integration</a></li><li><a href="/manuals/2.2.3/5/How-to-boot-live-cds.html">How-to-boot-live-cds</a></li><li><a href="/manuals/2.2.3/5/Memtest.html">Memtest</a></li><li><a href="/manuals/2.2.3/5/Moving-your-install.html">Moving-your-install</a></li><li><a href="/manuals/2.2.3/5/Multiple-cobbler-server-addresses.html">Multiple-cobbler-server-addresses</a></li><li><a href="/manuals/2.2.3/5/Power-management.html">Power-management</a></li><li><a href="/manuals/2.2.3/5/Pxe-boot-menu-passwords.html">Pxe-boot-menu-passwords</a></li><li><a href="/manuals/2.2.3/5/Selinux.html">Selinux</a></li><li><a href="/manuals/2.2.3/5/System-retirement.html">System-retirement</a></li><li><a href="/manuals/2.2.3/5/Using-cobbler-with-a-configuration-management-system.html">Using-cobbler-with-a-configuration-management-system</a></li><li><a href="/manuals/2.2.3/5/Virtual-image-cloning.html">Virtual-image-cloning</a></li><li><a href="/manuals/2.2.3/5/X_-_Extending_Cobbler.html">X - Extending Cobbler</a></li><ul class="dirtree"><li><a href="/manuals/2.2.3/5/X/Extending-cheetah.html">X.Extending-cheetah</a></li><li><a href="/manuals/2.2.3/5/X/Modules.html">X.Modules</a></li><li><a href="/manuals/2.2.3/5/X/Triggers.html">X.Triggers</a></li></ul></ul></div>
    </div> <!-- rightcol -->
    <div id="content">
<h2>Using DBAN with Cobbler to automate system retirement</h2>

<h3>Introduction</h3>

<p>The following method details using <a href="http://dban.sourceforge.net/">DBAN</a> with Cobbler to create a PXE boot image that will securely wipe the disk of the system being retired. This could also be used if you are shipping a disk back to the manufacturer and wanted to ensure all data is "securely" wiped.</p>

<h3>Steps</h3>

<h4>DBAN 2.2.6</h4>

<p>Retrieve the extra loader parts that DBAN 2.2.6 needs:</p>

<pre><code>cobbler get-loaders
</code></pre>

<p>Download DBAN:</p>

<pre><code>wget -O /tmp/dban-2.2.6_i586.iso http://prdownloads.sourceforge.net/dban/dban-2.2.6_i586.iso
</code></pre>

<p>Mount the ISO and copy the kernel image file and (optionally) the boot configuration file:</p>

<pre><code>mount -o loop,ro /tmp/dban-2.2.6_i586.iso /mnt
mkdir -p /opt/cobbler/dban-2.2.6
cp -p /mnt/dban.bzi /opt/cobbler/dban-2.2.6/
cp -p /mnt/isolinux.cfg /opt/cobbler/dban-2.2.6/
chmod -x /opt/cobbler/dban-2.2.6/*
umount /mnt
</code></pre>

<p>Add the DBAN distro and profile to Cobbler.  Run sync to copy the loaders into place:</p>

<pre><code>cobbler distro add --name=DBAN-2.2.6-i586 --kernel=/opt/cobbler/dban-2.2.6/dban.bzi \
  --initrd=/opt/cobbler/dban-2.2.6/dban.bzi --kopts="nuke=dwipe silent"
cobbler profile add --name=DBAN-2.2.6-i586 --distro=DBAN-2.2.6-i586
cobbler sync
</code></pre>

<h4>DBAN 1.0.7</h4>

<p>Download DBAN:</p>

<pre><code>wget -O /tmp/dban-1.0.7_i386.iso http://prdownloads.sourceforge.net/dban/dban-1.0.7_i386.iso
</code></pre>

<p>Mount the ISO and copy the floppy disk image file:</p>

<pre><code>mount -o loop,ro /tmp/dban-1.0.7_i386.iso /mnt
cp -p /mnt/dban_1_0_7_i386.ima /tmp/
umount /mnt
</code></pre>

<p>Mount the floppy disk image file and copy the kernel image file, initial ram disk, and (optionally) the boot configuration file:</p>

<pre><code>mount -o loop,ro /tmp/dban_1_0_7_i386.ima /mnt
mkdir -p /opt/cobbler/dban-1.0.7
cp -p /mnt/initrd.gz /opt/cobbler/dban-1.0.7/
cp -p /mnt/kernel.bzi /opt/cobbler/dban-1.0.7/
cp -p /mnt/syslinux.cfg /opt/cobbler/dban-1.0.7/
chmod -x /opt/cobbler/dban-1.0.7/*
umount /mnt
</code></pre>

<p>Add the DBAN distro and profile to Cobbler:</p>

<pre><code>cobbler distro add --name=DBAN-1.0.7-i386 --kernel=/opt/cobbler/dban-1.0.7/kernel.bzi \
  --initrd=/opt/cobbler/dban-1.0.7/initrd.gz --kopts="root=/dev/ram0 init=/rc nuke=dwipe floppy=0,16,cmos"
cobbler profile add --name=DBAN-1.0.7-i386 --distro=DBAN-1.0.7-i386
</code></pre>

<h3>Test</h3>

<ol>
<li><p>Add a system to be destroyed:</p>

<p> cobbler system add --name=00:15:c5:c0:05:58 --profile=DBAN-1.0.7-i386</p></li>
<li><p>Sync cobbler:</p>

<p> cobbler sync</p></li>
<li><p>Boot the system via PXE. The DBAN menu will pop up. Select the drives and hit F10 to start the wipe.</p></li>
<li><p>Remove the system from this profile so that you don't accidentally boot and wipe in the future:</p>

<p> cobbler system remove --name=00:15:c5:c0:05:58</p></li>
</ol>


<h3>Notes</h3>

<p>You can setup DBAN to autowipe the system in question by supplying the kernel option of nuke="dwipe --autonuke". We are not doing it in this example because people sometimes only half-read things and it would suck to find out too late that you'd wiped a system you didn't mean to.</p>

<p>It should go without saying that, while it might be a mildly fun prank, you shouldn't set this to be your default pxe boot menu choice. You'll most likely get fired and/or beat up by your fellow employees.</p>

<p>If you do set this profile, it will show up as an option in the PXE menus. If this concerns you, set up a syslinux password by editing the templates in /etc/cobbler to ensure no one walks up to a system and blitzes it involuntarily. An option to keep a profile out of the PXE menu is doable if enough people request it or someone wants to submit a patch...</p>

     <div id="push"></div> <!-- push -->
    </div> <!-- content -->
  </div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div class="contact">&copy; 2012</div>
</div>

<!-- Google Analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27319020-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- Google Analytics end -->

</body>
</html>

