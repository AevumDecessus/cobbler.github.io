<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Cobbler Manual</title>
   <meta name="author" content="Cobbler development team" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/style.css" type="text/css" />

   <!-- Fonts -->
   <link href='http://fonts.googleapis.com/css?family=Signika|Ovo' rel='stylesheet' type='text/css'>

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

   <!-- Icon -->
   <link rel="icon" type="image/png" href="/images/favicon.png" />

   <!-- searching -->
   <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
   <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
   <link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" />
   <script type="text/javascript" src="/scripts/search.js"></script>
</head>
<body>

<!-- ClickTale Top part -->
<script type="text/javascript">
var WRInitTime=(new Date()).getTime();
</script>
<!-- ClickTale end of Top part -->


<div id="wrapper">
  <div id="header">
    <img id="logo" src="/images/logo-cobbler.png" alt="logo" />
    <div id="searchdiv">
<script type="text/javascript">
function do_search() {
  run_search(function doit() {
  var resultsdiv = $('div#results');
  var itemsdiv = $('div#items');

  if (final_results.length > 0) {
    html = '<ul>';
    $.each(final_results, function(idx,obj) {
      var title = obj["t"];
      var link = obj["u"];
      html += '<li><a href="'+link+'">'+title+'</a></li>';
    });
    html += '</ul>';
    itemsdiv.html(html);
  } else {
    itemsdiv.html('<p class="error">No search results found.</p>');
  }

  if (!resultsdiv.is(":visible")) {
    resultsdiv.css({top:0,left:0,width:"300px","max-height":"100px"}).position({
      my: "left top",
      at: "left bottom",
      of: "input#searchbox",
      offset: "0 0",
      collision: "none"
    }).fadeIn();
  }
  });
}

function close_results() {
  var resultsdiv = $('div#results');
  if (resultsdiv.is(":visible")) {
    resultsdiv.fadeOut();
  }
}
</script>
      <input id="searchbox" class="search" type="text" />
      <input id="searchbutton" class="search" type="button" value="search" onclick="do_search();" />
      <div id="results" class="menu">
        <!--<a href="javascript:close_results();"><img src="/images/cancel.png" /></a>-->
        <input type="image" src="/images/cancel.png" onclick="javascript:close_results();" />
        <div id="items"></div>
      </div>
    </div>

  </div> <!-- header -->
  <div id="container">
    <div id="leftcol">
<div id="mainmenu" class="menu">
  <div class="heading">Main Menu</div>
  <ul>
    <li><a href="/" title="Index">Home</a></li>
    <li><a href="/about.html" title="About Cobbler">About Cobbler</a></li>
    <li><a href="/users.html" title="Who's Using Cobbler">Who's Using Cobbler</a></li>
    <li class="last"><a href="/community.html" title="Cobbler Community">Cobbler Community</a></li>
  </ul>
  <div class="heading">Manuals</div>
  <ul>
    <li class="last"><a href="/manuals/2.2.3/" title="Version 2.2.3">Version 2.2.3</a></li>
  </ul>
  <div class="heading">Github</div>
  <ul>
    <li><a href="https://github.com/cobbler/cobbler" title="Main Repo" target="_blank">Main Repo</a></li>
    <li><a href="https://github.com/cobbler/cobbler/issues" title="Issues" target="_blank">Issue Tracker</a></li>
    <li class="last"><a href="https://github.com/cobbler/cobbler/wiki" title="Github Wiki" target="_blank">Wiki</a></li>
  </ul>
</div>

    </div> <!-- leftcol -->
    <div id="rightcol">
<div class="toc"><ul class="dirtree"><li><a href="/manuals/2.2.3/5/1_-_Advanced_Networking.html">1 - Advanced Networking</a></li><ul class="dirtree"><li><a href="/manuals/2.2.3/5/1/1_-_Bonding.html">1.1 - Bonding</a></li><li><a href="/manuals/2.2.3/5/1/2_-_VLANs.html">1.2 - VLANs</a></li><li><a href="/manuals/2.2.3/5/1/3_-_Bridging.html">1.3 - Bridging</a></li></ul><li><a href="/manuals/2.2.3/5/2_-_SELinux.html">2 - SELinux</a></li><li><a href="/manuals/2.2.3/5/3_-_File_System_ACLs.html">3 - File System ACLs</a></li><li><a href="/manuals/2.2.3/5/4_-_Extending_Cobbler.html">4 - Extending Cobbler</a></li><ul class="dirtree"><li><a href="/manuals/2.2.3/5/4/1_-_Triggers.html">4.1 - Triggers</a></li><li><a href="/manuals/2.2.3/5/4/2_-_Modules.html">4.2 - Modules</a></li><li><a href="/manuals/2.2.3/5/4/3_-_Extending_Cheetah.html">4.3 - Extending Cheetah</a></li></ul><li><a href="/manuals/2.2.3/5/5_-_Anaconda_Monitoring.html">5 - Anaconda Monitoring</a></li><li><a href="/manuals/2.2.3/5/6_-_Configuration_Management.html">6 - Configuration Management</a></li><ul class="dirtree"><li><a href="/manuals/2.2.3/5/6/1_-_Built-In_Configuration_Management.html">6.1 - Built-In Configuration Management</a></li><li><a href="/manuals/2.2.3/5/6/2_-_Puppet_Integration.html">6.2 - Puppet Integration</a></li><li><a href="/manuals/2.2.3/5/6/3_-_Func_Integration.html">6.3 - Func Integration</a></li></ul><li><a href="/manuals/2.2.3/5/7_-_Power_Management.html">7 - Power Management</a></li><li><a href="/manuals/2.2.3/5/8_-_Alternative_Template_Formats.html">8 - Alternative Template Formats</a></li><li><a href="/manuals/2.2.3/5/9_-_Multi-Homed_Cobbler_Server.html">9 - Multi-Homed Cobbler Server</a></li><li><a href="/manuals/2.2.3/5/10_-_Memtest.html">10 - Memtest</a></li><li><a href="/manuals/2.2.3/5/11_-_Virtual_Image_Cloning.html">11 - Virtual Image Cloning</a></li><li><a href="/manuals/2.2.3/5/12_-_Auto-Registration.html">12 - Auto-Registration</a></li><li><a href="/manuals/2.2.3/5/13_-_Booting_Live_CDs.html">13 - Booting Live CDs</a></li><li><a href="/manuals/2.2.3/5/14_-_Clonezilla_Integration.html">14 - Clonezilla Integration</a></li><li><a href="/manuals/2.2.3/5/15_-_Batch_Editing.html">15 - Batch Editing</a></li><li><a href="/manuals/2.2.3/5/16_-_Moving_to_a_New_Server.html">16 - Moving to a New Server</a></li><li><a href="/manuals/2.2.3/5/17_-_PXE-boot_Menu_Passwords.html">17 - PXE-boot Menu Passwords</a></li><li><a href="/manuals/2.2.3/5/18_-_System_Retirement.html">18 - System Retirement</a></li></ul></div>
    </div> <!-- rightcol -->
    <div id="content">
<p>This page details the <strong>Ana</strong>conda <strong>Mon</strong>itoring service available
in cobbler.  As the Anaconda monitor is rather distribution specific,
support for it is considered deprecated at this time.</p>

<h2>History</h2>

<p>Prior to Cobbler 1.6 , remote monitoring of installing systems was
limited to distributions that accept the the boot argument
<em>syslog=</em>. While this is supported in RHEL-5 and newer Red Hat
based distributions, it has several shortcomings.</p>

<p><strong>Reduces available kernel command-line length</strong>
  ~ The kernel command-line has a limited amount of space, relying</p>

<pre><code>on *syslog=somehost.example.com* reduces available argument space.
Cobbler has smarts to not add the *syslog=* parameter if no space
is available. But doing so disables remote monitoring.
</code></pre>

<p><strong>Only captures syslog</strong>
  ~ The <em>syslog=</em> approach will only capture syslog-style messages.</p>

<pre><code>Any command-specific output (/tmp/lvmout, /tmp/ks-script,
/tmp/X.config) or installation failure (/tmp/anacdump.txt)
information is not sent.
</code></pre>

<p><strong>Unsupported on older distros</strong>
  ~ While capturing syslog information is key for remote monitoring</p>

<pre><code>of installations, the
[anaconda](http://fedoraproject.org/wiki/Anaconda) installer only
supports sending syslog data for RHEL-5 and newer distributions.
</code></pre>

<h2>What is Anamon?</h2>

<p>In order to overcome the above obstacles, the <em>syslog=</em> remote
monitoring has been replaced by a python service called <strong>anamon</strong>
(Anaconda Monitor). Anamon is a python daemon (which runs inside
the installer while it is installing) that connects to the cobbler
server via XMLRPC and uploads a pre-determined set of files. Anamon
will continue monitoring files for updates and send any new data to
the cobbler server.</p>

<h2>How To Enable?</h2>

<p>To enable anamon for your Red Hat based distribution installations,
edit <em>/etc/cobbler/settings</em> and set:</p>

<pre><code>anamon_enabled: 1
</code></pre>

<p><strong>NOTE:</strong> Enabling anamon allows an xmlrpc call to send create and
update log files in the anamon directory, without authentication,
so enable only if you are ok with this limitation. It could be
potentially used by users to flood the log files or fill up the
server, which you probably don't want in an untrusted environment.
However, even so, it may be good for debugging complex installs.</p>

<p>You will also need to update your kickstart templates to include
the following snippets.</p>

<pre><code>%pre
$SNIPPET('pre_anamon')
</code></pre>

<p>Anamon can also send /var/log/messages and /var/log/boot.log once
your provisioned system has booted. To also enable post-install
boot notification, you must enable the following snippet:</p>

<pre><code>%post
$SNIPPET('post_anamon')
</code></pre>

<h3>Older Distributions</h3>

<p>Anamon relies on a %pre installation script that uses a python
<em>xmlrpc</em> library. The installation image used by Red Hat Enterprise
Linux 4 and older distributions for <em><a href="http://">http://</a></em> installs
does not provide the needed python libraries. There are several
ways to get around this ...</p>

<ol>
<li>Always perform a graphical or <strong>vnc</strong> install - installing
graphically (or by vnc) forces anaconda to download the
<em>stage2.img</em> that includes graphics support <strong>and</strong> the required
python xmlrpc library.</li>
<li>Install your system over nfs - nfs installations will also use
the <em>stage2.img</em> that includes python xmlrpc support</li>
<li><p>Install using an <em>updates.img</em> - Provide the missing xmlrpc
library by building an updates.img for use during installation. To
construct an <em>updates.img</em>, follow the steps below:</p>

<h1>dd if=/dev/zero of=updates.img bs=1k count=1440</h1>

<h1>mke2fs updates.img</h1>

<h1>tmpdir=<code>mktemp -d</code></h1>

<h1>mount -o loop updates.img $tmpdir</h1>

<h1>mkdir $tmpdir/cobbler</h1>

<h1>cp /usr/lib64/python2.3/xmlrpclib.* $tmpdir/cobbler</h1>

<h1>cp /usr/lib64/python2.3/xmllib.* $tmpdir/cobbler</h1>

<h1>cp /usr/lib64/python2.3/shlex.* $tmpdir/cobbler</h1>

<h1>cp /usr/lib64/python2.3/lib-dynload/operator.* $tmpdir/cobbler</h1>

<h1>umount $tmpdir</h1>

<h1>rmdir $tmpdir</h1></li>
</ol>


<p>More information on building and using an <em>updates.img</em> is
available from
<a href="http://fedoraproject.org/wiki/Anaconda/Updates">http://fedoraproject.org/wiki/Anaconda/Updates</a>.</p>

<h2>Where Is Information Saved?</h2>

<p>All anamon logs are stored in a system-specific directory under
<em>/var/log/cobbler/anamon/systemname</em>. For example,</p>

<pre><code># ls /var/log/cobbler/anamon/vguest3
anaconda.log  boot.log  dmesg  install.log  ks.cfg  lvmout.log  messages  sys.log
</code></pre>

     <div id="push"></div> <!-- push -->
    </div> <!-- content -->
  </div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div class="contact">&copy; 2012</div>
</div>

<!-- Google Analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27319020-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- Google Analytics end -->

</body>
</html>

